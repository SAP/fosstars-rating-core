package com.sap.sgs.phosphor.fosstars.model.score.oss;

import static com.sap.sgs.phosphor.fosstars.model.feature.oss.OssFeatures.VULNERABILITIES;
import static com.sap.sgs.phosphor.fosstars.model.value.Vulnerability.Builder.newVulnerability;

import com.sap.sgs.phosphor.fosstars.model.Value;
import com.sap.sgs.phosphor.fosstars.model.other.Utils;
import com.sap.sgs.phosphor.fosstars.model.value.ScoreValue;
import com.sap.sgs.phosphor.fosstars.model.value.Vulnerabilities;
import java.util.Date;
import java.util.Set;
import org.junit.Test;

public class VulnerabilityDiscoveryAndSecurityTestingScoreTest {

  private static ProjectSecurityTestingScore SECURITY_TESTING_SCORE
      = new ProjectSecurityTestingScore();

  @Test(expected = IllegalArgumentException.class)
  public void testWithNoVulnerabilitiesInfo() {
    VulnerabilityDiscoveryAndSecurityTestingScore score
        = new VulnerabilityDiscoveryAndSecurityTestingScore(SECURITY_TESTING_SCORE);
    ScoreValue securityTestingScoreValue = new ScoreValue(SECURITY_TESTING_SCORE);
    score.calculate(securityTestingScoreValue);
  }

  @Test
  public void testCalculate() {
    Set<Value> values = Utils.allUnknown(SECURITY_TESTING_SCORE.allFeatures());
    values.add(VULNERABILITIES.value(
        new Vulnerabilities(
            newVulnerability("CVE-1")
                .published(new Date())
                .make())));

  }
}