package com.sap.sgs.phosphor.fosstars.model.score.oss;

import static com.sap.sgs.phosphor.fosstars.TestUtils.assertScore;
import static com.sap.sgs.phosphor.fosstars.model.feature.oss.OssFeatures.FIRST_COMMIT_DATE;
import static com.sap.sgs.phosphor.fosstars.model.feature.oss.OssFeatures.PROJECT_START_DATE;
import static com.sap.sgs.phosphor.fosstars.model.feature.oss.OssFeatures.VULNERABILITIES;
import static com.sap.sgs.phosphor.fosstars.model.other.Utils.setOf;

import com.sap.sgs.phosphor.fosstars.model.Score;
import com.sap.sgs.phosphor.fosstars.model.Value;
import com.sap.sgs.phosphor.fosstars.model.other.Utils;
import com.sap.sgs.phosphor.fosstars.model.value.Vulnerabilities;
import java.util.Date;
import java.util.Set;
import org.junit.Test;

public class VulnerabilityLifetimeScoreTest {

  @Test
  public void calculateForAllUnknown() {
    Score score = new VulnerabilityLifetimeScore();
    assertScore(Score.MIN, score, Utils.allUnknown(score.allFeatures()));
  }

  @Test
  public void calculate() {
    Score score = new VulnerabilityLifetimeScore();
    Set<Value> values = setOf(
        VULNERABILITIES.value(new Vulnerabilities()),
        PROJECT_START_DATE.value(new Date()),
        FIRST_COMMIT_DATE.value(new Date()));
    assertScore(Score.INTERVAL, score, values);
  }

  @Test(expected = IllegalArgumentException.class)
  public void noInfoAboutVulnerabilities() {
    Score score = new VulnerabilityLifetimeScore();
    Set<Value> values = setOf(
        PROJECT_START_DATE.value(new Date()),
        FIRST_COMMIT_DATE.value(new Date()));
    assertScore(Score.INTERVAL, score, values);
  }
}